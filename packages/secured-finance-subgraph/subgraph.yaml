specVersion: 0.0.2
description: Secured Finance is decentralized P2P banking business for digital assets 
repository: https://github.com/secured-finance/secured-finance-subgraph
schema:
  file: ./schema.graphql
dataSources:
  - kind: ethereum/contract
    name: Loan
    network: mainnet
    source:
      address: '0x7D25E74029976f675A23Ac444d57fD59ca999727'
      abi: Loan
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Loan
        - LoanSchedule
        - SchedulePayment
      abis:
        - name: Loan
          file: ./abis/Loan.json
      eventHandlers:
        - event: MakeLoanDeal(indexed address,indexed address,uint8,uint8,uint8,uint256,uint256,indexed uint256)
          handler: handleMakeLoanDeal
        - event: NotifyPayment(indexed address,indexed address,uint8,uint8,uint256,uint256,uint256,indexed bytes32)
          handler: handleNotifyLoanPayment
        - event: ConfirmPayment(indexed address,indexed address,uint8,uint8,uint256,uint256,uint256,indexed bytes32)
          handler: handleConfirmLoanPayment
        - event: UpdateState(indexed address,indexed address,indexed uint256,uint8,uint8)
          handler: handleUpdateLoanState
      file: ./src/loan.ts
  - kind: ethereum/contract
    name: Collateral
    network: mainnet
    source:
      address: '0xce6027F8cBab5a96FF345E481daB069030E81cb7'
      abi: Collateral
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - Collateral
      abis:
        - name: Collateral
          file: ./abis/Collateral.json
      eventHandlers:
        - event: SetColBook(indexed address,indexed string,bytes32,address)
          handler: handleSetCollateralBook
        - event: UpSizeETH(indexed address)
          handler: handleUpSizeETH
        - event: UpSizeFIL(indexed address,uint256,bytes32)
          handler: handleUpSizeFIL
        - event: ConfirmUpSizeFIL(indexed address,indexed bytes32,uint256,indexed bytes32)
          handler: handleConfirmUpSizeFIL
        - event: DelColBook(indexed address)
          handler: handleDeleteCollateralBook
        - event: PartialLiquidation(indexed address,indexed address,indexed uint256,uint8)
          handler: handlePartialLiquidation
      file: ./src/collateral.ts
  - kind: ethereum/contract
    name: LendingMarketController
    network: mainnet
    source:
      address: '0x950C34a09Ce94ad6e89d5e31eDa0719737ffE144'
      abi: LendingMarketController
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - LendingMarketController
      abis:
        - name: LendingMarketController
          file: ./abis/LendingMarketController.json
      eventHandlers:
        - event: LendingMarketCreated(uint8,uint8,indexed address)
          handler: handleNewLendingMarket
      file: ./src/lendingController.ts
templates:
  - kind: ethereum/contract
    name: LendingMarket
    network: mainnet
    source:
      abi: LendingMarket
    mapping:
      kind: ethereum/events
      apiVersion: 0.0.4
      language: wasm/assemblyscript
      entities:
        - LendingMarket
        - LendingMarketOrderRow
        - LendingMarketOrderItem
        - FilledLendingMarketOrder
      abis:
        - name: LendingMarket
          file: ./abis/LendingMarket.json
      eventHandlers:
        - event: MakeOrder(uint256,indexed address,uint8,uint8,uint8,uint256,uint256,uint256)
          handler: handleMakeLendingOrder
        - event: TakeOrder(uint256,indexed address,uint8,uint256,uint256)
          handler: handleTakeLendingOrder
        - event: CancelOrder(uint256,indexed address,uint8,uint256,uint256)
          handler: handleCancelLendingOrder
      file: ./src/lendingMarket.ts
